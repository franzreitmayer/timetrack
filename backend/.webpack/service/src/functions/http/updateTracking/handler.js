(()=>{"use strict";var e={778:(e,t,r)=>{r.d(t,{Zq:()=>o}),r(231);const i=new(r(162).a);async function o(e){return await i.updateTimetrack(e)}},162:(e,t,r)=>{r.d(t,{a:()=>s});var i=r(480),o=r(922),a=r(845);const n=o.captureAWS(i);class s{constructor(e=function(){return new n.DynamoDB.DocumentClient}(),t=process.env.TTRACK_TABLE,r=process.env.SECONDARY_INDEX,i=(0,a.h)("TIMETRACK_ACCESS")){this.docClient=e,this.timetrackTable=t,this.indexName=r,this.LOGGER=i}async getAllTimetrackings(e){var t;this.LOGGER.info("Getting all todo items");try{t=await this.docClient.query({TableName:this.timetrackTable,IndexName:this.indexName,KeyConditionExpression:"userId = :userId",ExpressionAttributeValues:{":userId":e}}).promise()}catch(e){this.LOGGER.error("error during query").error(JSON.stringify(e))}return console.log("Got result from dynamodb: "+JSON.stringify(t)),t.Items}async createTimetrack(e){this.LOGGER.info(`Creaing new Timetrack ${JSON.stringify(e)}`);try{await this.docClient.put({TableName:this.timetrackTable,Item:e}).promise(),this.LOGGER.info(`Timetrack written to db table ${this.timetrackTable}: ${JSON.stringify(e)}`)}catch(t){this.LOGGER.error(`Writing timetrack ${JSON.stringify(e)} to table ${this.timetrackTable} failed`,t)}return e}async updateTimetrack(e){this.LOGGER.info(`Updating Timetrack: ${e}`);try{await this.docClient.update({TableName:this.timetrackTable,Key:{userId:e.userId,trackingId:e.trackingId},UpdateExpression:"set  trackTo=:trackTo, \n                                        trackFrom=:trackFrom, \n                                        shortDescription=:shortDescription, \n                                        longDescription=:longDescription, \n                                        invoiced=:invoiced, \n                                        attachmentURL=:attachmentURL",ExpressionAttributeValues:{":trackTo":e.trackTo,":trackFrom":e.trackFrom,":shortDescription":e.shortDescription,":longDescription":e.longDescription,":invoiced":e.invoiced,":attachmentURL":e.attachmentUrl}}).promise(),this.LOGGER.info("Successfully updated timetrack",e)}catch(t){this.LOGGER.error("Error updating timetrack",t,e)}return e}async deleteTimetrack(e,t){this.LOGGER.info(`deleting timetrack with id: ${e} and userId: ${t}`);try{return await this.docClient.delete({TableName:this.timetrackTable,Key:{userId:t,trackId:e}}).promise(),this.LOGGER.info(`Successfully deleted timetrack with id ${e} and user ${t}`),!0}catch(r){return this.LOGGER.error(`Error while deleting trackId: ${e} and userId: ${t}`,r),!1}}}},444:(e,t,r)=>{r.d(t,{z:()=>s});var i=r(806),o=r.n(i),a=r(657),n=r.n(a);const s=e=>o()(e).use(n()())},845:(e,t,r)=>{r.d(t,{h:()=>o});var i=r(944);function o(e){return i.createLogger({level:"info",format:i.format.json(),defaultMeta:{name:e},transports:[new i.transports.Console]})}},806:e=>{e.exports=require("@middy/core")},657:e=>{e.exports=require("@middy/http-json-body-parser")},480:e=>{e.exports=require("aws-sdk")},922:e=>{e.exports=require("aws-xray-sdk")},43:e=>{e.exports=require("source-map-support/register")},231:e=>{e.exports=require("uuid")},944:e=>{e.exports=require("winston")}},t={};function r(i){if(t[i])return t[i].exports;var o=t[i]={exports:{}};return e[i](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};(()=>{r.r(i),r.d(i,{main:()=>t}),r(43);var e=r(778);const t=(0,r(444).z)((async t=>{console.log(JSON.stringify(t)),console.log(`event.body = ${t.body}`);const r=JSON.parse(JSON.stringify(t.body)),i=await(0,e.Zq)(r);return{statusCode:200,headers:{"Access-Control-Allow-Origin":"*"},body:JSON.stringify(i)}}))})();var o=exports;for(var a in i)o[a]=i[a];i.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
//# sourceMappingURL=handler.js.map